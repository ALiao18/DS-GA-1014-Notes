% !TEX root = ../main.tex
\section{Matrix Rank}

\begin{idea}
\textbf{Motivation:} Consider a dataset $x_{1},\dots,x_{n} \in \mathbb{R}^{d}$. What is its dimensionality?
There are many notions of dimensionality. The rank is one of them.
\end{idea}

\subsection{The Rank}

\begin{definition}[Rank of a Family]
    We can define the rank of a family $x_{1},\dots,x_{k}$ of vectors in $\mathbb{R}^{n}$ as the dimension of its span.
    \[ rank(x_{1},\dots,x_{k})\stackrel{\text{def}}{=}dim(Span(x_{1},\dots,x_{k})) \]
\end{definition}

\begin{definition}[Rank of a Matrix]
    Let $M \in \mathbb{R}^{n \times m}$ and $c_{1},\dots,c_{m} \in \mathbb{R}^{n}$ be its columns.
    \begin{align}
    rank(M)&\stackrel{\text{def}}{=}rank(c_{1},\dots,c_{m}) \\
    &=dim(\mathrm{Im}(M)) = dim(Span(c_{1},\dots,c_{m}))
    \end{align}
\end{definition}

\noindent $rank(M) \leq \min(m, n)$.

\subsubsection*{Examples}
\begin{enumerate}
    \item $rank(Id_{n})=dim(\mathbb{R}^{n})=n$.
    \item $rank(\begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix})=2$ (vectors are linearly independent).
    \item $rank(\begin{pmatrix} 1 & 2 & 1 \\ 0 & 0 & 1 \end{pmatrix}) = 2$.
\end{enumerate}

\begin{proposition}[Rank of columns = Rank of rows]
    Let $r_{1},\dots,r_{n} \in \mathbb{R}^{m}$ be the rows of $M$.
    \[ rank(r_{1},\dots r_{n}) = rank(c_{1},\dots c_{m}) = rank(M) \]
\end{proposition}

\subsection{Rank-Nullity Theorem}
\begin{theorem}[Rank-Nullity]
    Let $L: \mathbb{R}^{k} \to \mathbb{R}^{n}$ be a linear map.
    \[ \underbrace{dim(\mathbb{R}^{k})}_{\text{domain}} = \underbrace{dim(Ker(L))}_{\text{nullity}} + \underbrace{dim(\mathrm{Im}(L))}_{\text{rank}} \]
\end{theorem}

\begin{proof}
    \textbf{Inequality 2:} $rank(AB) \leq \min(rank(A), rank(B))$.
    Showing $rank(AB) \leq rank(B)$:
    Let $L_A, L_B$ be linear maps for $A$ and $B$.
    $Ker(B) \subseteq Ker(AB)$.
    Thus $dim(Ker(B)) \leq dim(Ker(AB))$.
    By Rank-Nullity: $rank(AB) = k - dim(Ker(AB)) \leq k - dim(Ker(B)) = rank(B)$.
\end{proof}

\subsection{Rank of invertible matrices}
\begin{theorem}
    Let $M \in \mathbb{R}^{n \times n}$. The following points are equivalent:
    \begin{enumerate}
        \item $M$ is invertible.
        \item $rank(M)=n$.
        \item $Ker(M)=\{ 0 \}$.
        \item $\forall y \in \mathbb{R}^{n}, \exists \text{ unique } x \in \mathbb{R}^{n} \text{ s.t. } Mx=y$.
    \end{enumerate}
\end{theorem}

\begin{proof}
    \textbf{$1 \rightarrow 2$:} Let $y \in \mathbb{R}^{n}$. $y=M(M^{-1}y)$, so $y \in \mathrm{Im}(M)$. Thus $\mathrm{Im}(M)=\mathbb{R}^n$, so $rank(M)=n$.
    \textbf{$2 \rightarrow 3$:} From Rank-Nullity, $dim(Ker(M))=n-rank(M)=0$.
    \textbf{$3 \rightarrow 4$:}
    Existence: $dim(\mathrm{Im}(M)) = n - dim(Ker(M)) = n$, so $\mathrm{Im}(M)=\mathbb{R}^n$.
    Uniqueness: If $Mx=Mx'$, then $M(x-x')=0 \implies x-x' \in Ker(M)=\{0\}$.
\end{proof}

\subsection{Transpose of a Matrix}
Let $M \in \mathbb{R}^{ n \times m}$. We define its transpose $M^{\top}\in \mathbb{R}^{m \times n }$ by $M^{\top}_{i,j}=M_{j,i}$ for all $i \in \{ 1,\dots,m \}$ and $j \in \{ 1,\dots,n \}$.
\begin{enumerate}
    \item $(M^{\top})^{\top}=M$.
    \item The mapping $M \mapsto M^{\top}$ is linear, so it is closed under addition and scalar multiplication.
\end{enumerate}

\subsubsection{Properties}
\begin{enumerate}
    \item $\forall A \in \mathbb{R}^{n \times m}, rank(A)=rank(A^{\top})$.
    (Rank of A = Rank of columns of A = Rank of rows of A transpose = Rank of A transpose).
    \item Let $A \in \mathbb{R}^{n \times m}, B \in \mathbb{R}^{m \times p}$. Then $(AB)^{\top} = B^{\top}A^{\top}$.
\end{enumerate}